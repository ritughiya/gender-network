"use strict";var Qo=Object.create;var ce=Object.defineProperty;var Yo=Object.getOwnPropertyDescriptor;var Jo=Object.getOwnPropertyNames;var er=Object.getPrototypeOf,tr=Object.prototype.hasOwnProperty;var or=(e,t)=>{for(var o in t)ce(e,o,{get:t[o],enumerable:!0})},et=(e,t,o,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of Jo(t))!tr.call(e,n)&&n!==o&&ce(e,n,{get:()=>t[n],enumerable:!(r=Yo(t,n))||r.enumerable});return e};var m=(e,t,o)=>(o=e!=null?Qo(er(e)):{},et(t||!e||!e.__esModule?ce(o,"default",{value:e,enumerable:!0}):o,e)),rr=e=>et(ce({},"__esModule",{value:!0}),e);var Qr={};or(Qr,{default:()=>Xr});module.exports=rr(Qr);var T=m(require("react"));var D=m(require("react")),tt=require("@iiif/vault"),ot={canvasBackgroundColor:"#e6e8eb",canvasHeight:"61.8vh",ignoreCaptionLabels:[],renderAbout:!0,showIIIFBadge:!0,showInformationToggle:!0,showTitle:!0},Pe={activeCanvas:"",activeManifest:"",collection:{},configOptions:ot,informationExpanded:!0,isLoaded:!1,vault:new tt.Vault},rt=D.default.createContext(Pe),nt=D.default.createContext(Pe);function nr(e,t){switch(t.type){case"updateActiveCanvas":return t.canvasId||(t.canvasId=""),{...e,activeCanvas:t.canvasId};case"updateActiveManifest":return{...e,activeManifest:t.manifestId};case"updateCollection":return{...e,collection:t.collection};case"updateConfigOptions":return{...e,configOptions:{...ot,...t.configOptions}};case"updateInformationExpanded":return{...e,informationExpanded:t.informationExpanded};case"updateIsLoaded":return{...e,isLoaded:t.isLoaded};default:throw new Error(`Unhandled action type: ${t.type}`)}}var it=({initialState:e=Pe,children:t})=>{let[o,r]=(0,D.useReducer)(nr,e);return D.default.createElement(rt.Provider,{value:o},D.default.createElement(nt.Provider,{value:r},t))};function w(){let e=D.default.useContext(rt);if(e===void 0)throw new Error("useViewerState must be used within a ViewerProvider");return e}function O(){let e=D.default.useContext(nt);if(e===void 0)throw new Error("useViewerDispatch must be used within a ViewerProvider");return e}var $=m(require("react"));function at(e){return e.service?`${e.service[0].id}/full/,${e.height||500}/0/default.jpg`:e.id}var $e=e=>{if(!!e)try{let t=e.thumbnail;return t&&t.length>0?at(t[0]):at(e.items[0].items[0].body)}catch(t){console.error("Error retrieving accompanying canvas image",t);return}};var j=(e,t,o,r)=>{var s,d;let n={canvas:void 0,accompanyingCanvas:void 0,annotationPage:void 0,annotations:[]},l=i=>{if(i){if(!i.body||!i.motivation){console.error("Invalid annotation after Hyperion parsing: missing either 'body' or 'motivation'",i);return}if(!i.body)return;let f=i.body;Array.isArray(f)&&(f=f[0]);let h=e.get(f.id);if(!h)return;switch(o){case"painting":return i.target===t.id&&i.motivation&&i.motivation[0]==="painting"&&r.includes(h.type)&&(i.body=h),i;case"supplementing":return;default:throw new Error("Invalid annotation motivation.")}}};return n.canvas=e.get(t),n.canvas&&(n.annotationPage=e.get(n.canvas.items[0]),n.accompanyingCanvas=(s=n.canvas)!=null&&s.accompanyingCanvas?e.get((d=n.canvas)==null?void 0:d.accompanyingCanvas):void 0),n.annotationPage&&(n.annotations=e.get(n.annotationPage.items).filter(l)),n};var H=(e,t="en")=>{if(!e)return"";if(!e[t]){let o=Object.getOwnPropertyNames(e);if(o.length>0)return e[o[0]]}return e[t]};var Ee=(e,t)=>{let o=j(e,{id:t,type:"Canvas"},"painting",["Image","Sound","Video"]);if(o.annotations.length!==0&&o.annotations[0]&&o.annotations[0].body)return o.annotations[0].body};var Ae=(e,t,o)=>{let r=e.get({id:t,type:"Canvas"});if(!(r!=null&&r.annotations)||!r.annotations[0])return[];let n=e.get(r.annotations[0]),l=e.get(n.items);return Array.isArray(l)?l.filter(s=>{var d;if(!!s.body&&(d=s.motivation)!=null&&d.includes("supplementing")){let i=s.body;Array.isArray(i)&&(i=i[0]);let f=e.get(i.id);if(f.format===o)return s.body=f,s}}).map(s=>s.body):[]};var Me=(e,t,o,r)=>{let n=[];if(t.canvas&&t.canvas.thumbnail.length>0){let d=e.get(t.canvas.thumbnail[0]);n.push(d)}if(t.annotations[0]){if(t.annotations[0].thumbnail&&t.annotations[0].thumbnail.length>0){let i=e.get(t.annotations[0].thumbnail[0]);n.push(i)}if(!t.annotations[0].body)return;let d=t.annotations[0].body;d.type==="Image"&&n.push(d)}return n.length===0?void 0:{id:n[0].id,format:n[0].format,type:n[0].type,width:o,height:r}};var st=require("@stitches/react"),ir={colors:{primary:"#1a1d1e",primaryMuted:"#26292b",primaryAlt:"#151718",accent:"#006adc",accentMuted:"#5eb0ef",accentAlt:"#00254d",secondary:"#FFFFFF",secondaryMuted:"#e6e8eb",secondaryAlt:"#c1c8cd"},fonts:{sans:"'Inter', Arial, sans-serif",display:"'Calistoga', 'Inter', Arial, sans-serif"},transitions:{all:"all 500ms cubic-bezier(0.16, 1, 0.3, 1)"}},We={xxs:"(max-width: 349px)",xs:"(max-width: 575px)",sm:"(max-width: 767px)",md:"(max-width: 991px)",xl:"(max-width: 1199px)",lg:"(min-width: 1200px)"},{styled:a,css:gn,keyframes:lt,createTheme:hn}=(0,st.createStitches)({theme:ir,media:We});var ue=m(require("@radix-ui/react-collapsible")),Le=a("div",{position:"relative",zIndex:"0"}),Ve=a("div",{display:"flex",flexDirection:"row",overflow:"hidden","@sm":{flexDirection:"column"}}),ze=a("div",{display:"flex",flexDirection:"column",flexGrow:"1",flexShrink:"1",width:"61.8%","@sm":{width:"100%"}}),dt=a(ue.Trigger,{display:"none",background:"transparent",border:"none",margin:"0",padding:"0",transition:"$all",opacity:"1",marginTop:"0","&[data-navigator='false']":{opacity:"0",marginTop:"-59px"},"@sm":{display:"flex","> span":{display:"flex",flexGrow:"1",margin:"1rem 1rem 0"}}}),Ne=a(ue.Content,{width:"100%",display:"flex"}),mt=a("aside",{display:"flex",flexGrow:"1",flexShrink:"0",width:"38.2%",maxHeight:"100%","@sm":{width:"100%"}}),pt=a("div",{display:"flex",flexDirection:"column",fontFamily:"$sans",backgroundColor:"$secondary",fontSmooth:"auto",webkitFontSmoothing:"antialiased","> div":{display:"flex",flexDirection:"column",flexGrow:"1",justifyContent:"flex-start","@sm":{[`& ${Ve}`]:{flexGrow:"1"},[`& ${ze}`]:{flexGrow:"0"}}},"@sm":{padding:"0"},"&[data-navigator-open='true']":{"@sm":{position:"fixed",height:"100%",width:"100%",top:"0",left:"0",zIndex:"2500000000",[`& ${Le}`]:{display:"none"},[`& ${Ne}`]:{height:"100%"}}}});var fe=require("react"),ct=e=>{let t=()=>window.matchMedia?window.matchMedia(e).matches:!1,[o,r]=(0,fe.useState)(t);return(0,fe.useEffect)(()=>{let n=()=>r(t);return window.addEventListener("resize",n),()=>window.removeEventListener("resize",n)}),o};var Y=require("react"),ut=(e=!1)=>{let[t,o]=(0,Y.useState)(e);return(0,Y.useLayoutEffect)(()=>{if(!t)return;let r=document.documentElement.style.overflow;return document.documentElement.style.overflow="hidden",()=>{document.documentElement.style.overflow=r}},[t]),(0,Y.useEffect)(()=>{t!==e&&o(e)},[e]),[t,o]};var Zo=m(require("@radix-ui/react-collapsible"));var P=m(require("react"));var Be=require("@nulib/design-system");var G=m(require("@radix-ui/react-select"));var ft=a("svg",{height:"19px",color:"$accent",fill:"$accent",stroke:"$accent",display:"flex",margin:"0.25rem 0.85rem"}),gt=a(G.Trigger,{fontSize:"1.25rem",fontWeight:"400",fontFamily:"$display",alignSelf:"flex-start",flexGrow:"1",backgroundColor:"$secondary",cursor:"pointer",transition:"$all",border:"1px solid $secondaryMuted",boxShadow:"2px 2px 5px #0001",borderRadius:"3px",display:"flex",alignItems:"center",paddingLeft:"0.5rem","@sm":{fontSize:"1rem"}}),ht=a(G.Content,{borderRadius:"3px",boxShadow:"3px 3px 8px #0003",backgroundColor:"$secondary",marginTop:"2.25rem",marginLeft:"6px",paddingBottom:"0.25rem",maxHeight:"calc(61.8vh - 2.5rem) !important",borderTopLeftRadius:"0",border:"1px solid $secondaryMuted",maxWidth:"90vw"}),bt=a(G.Item,{display:"flex",alignItems:"center",fontFamily:"$sans",padding:"0.25rem 0.5rem",color:"$primary",fontWeight:"400",fontSize:"0.8333rem",cursor:"pointer",backgroundColor:"$secondary",width:"calc(100% - 1rem)","> span":{whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden"},'&[data-state="checked"]':{fontWeight:"700",color:"$primary !important"},"&:hover":{color:"$accent"},img:{width:"31px",height:"31px",marginRight:"0.5rem",borderRadius:"3px"}}),xt=a(G.Label,{color:"$primaryMuted",fontFamily:"$sans",fontSize:"0.85rem",padding:"0.5rem 1rem 0.5rem 0.5rem",display:"flex",alignItems:"center",marginBottom:"0.25rem",borderRadius:"3px",borderTopLeftRadius:"0",borderBottomLeftRadius:"0",borderBottomRightRadius:"0",backgroundColor:"$secondaryMuted"}),ge=a("div",{position:"relative",zIndex:"5"});var yt=a(Be.Popover.Trigger,{width:"30px",padding:"5px",margin:"0 0 0 2rem"}),Ct=a(Be.Popover.Content,{display:"flex",flexDirection:"column",fontSize:"0.8333rem",border:"none",boxShadow:"2px 2px 5px #0003",zIndex:"2",button:{display:"flex",textDecoration:"none",fontFamily:"$sans",marginBottom:"0.5em",color:"$accentAlt",cursor:"pointer",background:"$secondary",border:"none",["&:last-child"]:{marginBottom:"0"}}}),vt=a("span",{fontSize:"1.25rem",fontWeight:"700",fontFamily:"$display",alignSelf:"flex-start",flexGrow:"1",flexShrink:"0","@sm":{fontSize:"1rem"}}),It=a("header",{display:"flex",backgroundColor:"transparent !important",justifyContent:"flex-end",padding:"1rem",[`> ${ge}`]:{flexGrow:"1",flexShrink:"0"},form:{flexGrow:"0",flexShrink:"1"}});var Mt=require("@nulib/design-system");var L=m(require("react")),ar=()=>{let e="#ed1d33",t="#2873ab";return L.default.createElement("svg",{viewBox:"0 0 493.35999 441.33334",id:"iiif-logo",version:"1.1"},L.default.createElement("title",null,"IIIF Manifest Options"),L.default.createElement("g",{transform:"matrix(1.3333333,0,0,-1.3333333,0,441.33333)"},L.default.createElement("g",{transform:"scale(0.1)"},L.default.createElement("path",{style:{fill:t},d:"M 65.2422,2178.75 775.242,1915 773.992,15 65.2422,276.25 v 1902.5"}),L.default.createElement("path",{style:{fill:t},d:"m 804.145,2640.09 c 81.441,-240.91 -26.473,-436.2 -241.04,-436.2 -214.558,0 -454.511,195.29 -535.9527,436.2 -81.4335,240.89 26.4805,436.18 241.0387,436.18 214.567,0 454.512,-195.29 535.954,-436.18"}),L.default.createElement("path",{style:{fill:e},d:"M 1678.58,2178.75 968.578,1915 969.828,15 1678.58,276.25 v 1902.5"}),L.default.createElement("path",{style:{fill:e},d:"m 935.082,2640.09 c -81.437,-240.91 26.477,-436.2 241.038,-436.2 214.56,0 454.51,195.29 535.96,436.2 81.43,240.89 -26.48,436.18 -241.04,436.18 -214.57,0 -454.52,-195.29 -535.958,-436.18"}),L.default.createElement("path",{style:{fill:t},d:"m 1860.24,2178.75 710,-263.75 -1.25,-1900 -708.75,261.25 v 1902.5"}),L.default.createElement("path",{style:{fill:t},d:"m 2603.74,2640.09 c 81.45,-240.91 -26.47,-436.2 -241.03,-436.2 -214.58,0 -454.52,195.29 -535.96,436.2 -81.44,240.89 26.48,436.18 241.03,436.18 214.57,0 454.51,-195.29 535.96,-436.18"}),L.default.createElement("path",{style:{fill:e},d:"m 3700.24,3310 v -652.5 c 0,0 -230,90 -257.5,-142.5 -2.5,-247.5 0,-336.25 0,-336.25 l 257.5,83.75 V 1690 l -258.61,-92.5 V 262.5 L 2735.24,0 v 2360 c 0,0 -15,850 965,950"}))))},wt=ar;var he=m(require("react"));var J=require("react"),St=(e,t=2500)=>{let[o,r]=(0,J.useState)(),n=(0,J.useCallback)(()=>{navigator.clipboard.writeText(e).then(()=>r("copied"),()=>r("failed"))},[e]);return(0,J.useEffect)(()=>{if(!o)return;let l=setTimeout(()=>r(void 0),t);return()=>clearTimeout(l)},[o]),[o,n]};var sr=a("span",{display:"flex",alignContent:"center",alignItems:"center",padding:"0.125rem 0.25rem 0",marginTop:"-0.125rem",marginLeft:"0.5rem",backgroundColor:"$accent",color:"$secondary",borderRadius:"3px",fontSize:"0.6111rem",textTransform:"uppercase",lineHeight:"1em"}),lr=({status:e})=>e?he.default.createElement(sr,{"data-copy-status":e},e):null,dr=({textPrompt:e,textToCopy:t})=>{let[o,r]=St(t);return he.default.createElement("button",{onClick:r},e," ",he.default.createElement(lr,{status:o}))},De=dr;var S=m(require("@radix-ui/react-select"));var ae=require("@samvera/nectar-iiif");var C=m(require("react"));var q=m(require("react"));var mr=({direction:e,title:t})=>q.default.createElement(ft,{xmlns:"http://www.w3.org/2000/svg",focusable:"false",viewBox:"0 0 512 512",role:"img"},q.default.createElement("title",null,t),e==="up"&&q.default.createElement(()=>q.default.createElement("path",{d:"M414 321.94L274.22 158.82a24 24 0 00-36.44 0L98 321.94c-13.34 15.57-2.28 39.62 18.22 39.62h279.6c20.5 0 31.56-24.05 18.18-39.62z"}),null),e==="down"&&q.default.createElement(()=>q.default.createElement("path",{d:"M98 190.06l139.78 163.12a24 24 0 0036.44 0L414 190.06c13.34-15.57 2.28-39.62-18.22-39.62h-279.6c-20.5 0-31.56 24.05-18.18 39.62z"}),null)),be=mr;var pr=()=>{let e=O(),t=w(),{activeManifest:o,collection:r,configOptions:n,vault:l}=t,s=n==null?void 0:n.canvasHeight;return C.default.createElement(ge,null,C.default.createElement(S.Root,{value:o,onValueChange:i=>{e({type:"updateActiveManifest",manifestId:i})}},C.default.createElement(gt,null,C.default.createElement(S.Value,null),C.default.createElement(S.Icon,null,C.default.createElement(be,{direction:"down",title:"select from collection"}))),C.default.createElement(ht,{css:{maxHeight:`${s} !important`}},C.default.createElement(S.ScrollUpButton,null,C.default.createElement(be,{direction:"up",title:"scroll up for more"})),C.default.createElement(S.Viewport,null,C.default.createElement(S.Group,null,C.default.createElement(xt,null,C.default.createElement(ae.Label,{label:r.label})),r.items.map(i=>C.default.createElement(bt,{value:i.id,key:i.id},C.default.createElement(ae.Thumbnail,{thumbnail:l.get(i.thumbnail)}),C.default.createElement(S.ItemText,null,C.default.createElement(ae.Label,{label:i.label})),C.default.createElement(S.ItemIndicator,null))))),C.default.createElement(S.ScrollDownButton,null,C.default.createElement(be,{direction:"down",title:"scroll down for more"})))))},Tt=pr;var Wt=require("@samvera/nectar-iiif");var V=m(require("react"));var xe=m(require("@radix-ui/react-switch")),kt=a(xe.Root,{all:"unset",height:"2rem",width:"3.236rem",backgroundColor:"$secondaryAlt",borderRadius:"9999px",position:"relative",WebkitTapHighlightColor:"transparent",cursor:"pointer","&:focus":{boxShadow:"0 0 0 2px $secondaryAlt"},'&[data-state="checked"]':{backgroundColor:"$accent",boxShadow:"inset 2px 2px 5px #0003"}}),Ft=a(xe.Thumb,{display:"block",height:"calc(2rem - 12px)",width:"calc(2rem - 12px)",backgroundColor:"$secondary",borderRadius:"100%",boxShadow:"2px 2px 5px #0001",transition:"$all",transform:"translateX(6px)",willChange:"transform",'&[data-state="checked"]':{transform:"translateX(calc(1.236rem + 6px))"}}),Pt=a("div",{display:"flex",alignItems:"center",paddingLeft:"1.618rem"}),$t=a("label",{fontSize:"0.8333rem",fontFamily:"$sans",fontWeight:"400",lineHeight:"1em",userSelect:"none",cursor:"pointer",color:"$primary",opacity:"0.7",paddingRight:"0.618rem"}),Et=a("form",{});var cr=()=>{let e=O(),[t,o]=(0,V.useState)(!0);return(0,V.useEffect)(()=>{e({type:"updateInformationExpanded",informationExpanded:t})},[t]),V.default.createElement(Et,null,V.default.createElement(Pt,null,V.default.createElement($t,{htmlFor:"information-toggle",css:t?{opacity:"1"}:{}},"More Information"),V.default.createElement(kt,{checked:t,onCheckedChange:()=>o(!t),id:"information-toggle"},V.default.createElement(Ft,null))))},At=cr;var ur=({manifestId:e,manifestLabel:t})=>{let o=w(),{collection:r,configOptions:n}=o,{showTitle:l,showIIIFBadge:s,showInformationToggle:d}=n;return!(r!=null&&r.items)&&!l&&!s&&!d?P.default.createElement(P.default.Fragment,null):P.default.createElement(It,{className:"clover-header"},r!=null&&r.items?P.default.createElement(Tt,null):P.default.createElement(vt,null,P.default.createElement(Wt.Label,{label:t})),s&&P.default.createElement(Mt.Popover,null,P.default.createElement(yt,null,P.default.createElement(wt,null)),P.default.createElement(Ct,null,(r==null?void 0:r.items)&&P.default.createElement("button",{onClick:i=>{i.preventDefault(),window.open(r.id,"_blank")}},"View Collection"),P.default.createElement("button",{onClick:i=>{i.preventDefault(),window.open(e,"_blank")}},"View Manifest")," ",(r==null?void 0:r.items)&&P.default.createElement(De,{textPrompt:"Copy Collection URL",textToCopy:r.id}),P.default.createElement(De,{textPrompt:"Copy Manifest URL",textToCopy:e}))),d&&P.default.createElement(At,null))},Lt=ur;var W=m(require("react"));var E=m(require("react"));var Vt=m(require("@radix-ui/react-radio-group"));var zt=a(Vt.Root,{display:"flex",flexDirection:"row",flexGrow:"1",padding:"1.618rem",overflowX:"scroll",position:"relative",zIndex:"0"});var k=m(require("react"));var fr=e=>{var t=e.toString().split(":"),o=Math.ceil(parseInt(t[0])),r=Math.ceil(parseInt(t[1])),n=gr(Math.ceil(parseInt(t[2])),2);let s=`${o!==0&&r<10?(r+"").padStart(2,"0"):r}:${n}`;return o!==0&&(s=`${o}:${s}`),s},ye=e=>{let t=new Date(e*1e3).toISOString().substr(11,8);return fr(t)};var gr=(e,t)=>String(e).padStart(t,"0");var U=require("@nulib/design-system");var Nt=m(require("@radix-ui/react-radio-group"));var He=require("@nulib/design-system"),Ce=a("span",{display:"flex"}),Bt=a("span",{display:"flex",width:"1.2111rem",height:"0.7222rem"}),Dt=a("span",{display:"inline-flex",marginLeft:"5px",marginBottom:"-1px"}),Ht=a(Nt.Item,{display:"flex",flexShrink:"0",margin:"0 1.618rem 0 0",padding:"0",cursor:"pointer",background:"none",border:"none",fontFamily:"inherit",lineHeight:"1.25em",fontSize:"1rem",textAlign:"left","&:last-child":{marginRight:"1rem"},figure:{margin:"0",width:"161.8px","> div":{position:"relative",display:"flex",backgroundColor:"$secondaryAlt",width:"inherit",height:"100px",overflow:"hidden",borderRadius:"3px",transition:"$all",img:{width:"100%",height:"100%",objectFit:"cover",filter:"blur(0)",transform:"scale3d(1, 1, 1)",transition:"$all",color:"transparent"},[`& ${Ce}`]:{position:"absolute",right:"0",bottom:"0",[`& ${He.Tag}`]:{margin:"0",paddingLeft:"0",fontSize:"0.7222rem",backgroundColor:"#000d",color:"$secondary",fill:"$secondary",borderBottomLeftRadius:"0",borderTopRightRadius:"0"}}},figcaption:{marginTop:"0.5rem",color:"$primaryMuted",fontWeight:"400",fontSize:"0.8333rem",display:"-webkit-box",overflow:"hidden",MozBoxOrient:"vertical",WebkitLineClamp:"5","@sm":{fontSize:"0.8333rem"}}},"&[aria-checked='true']":{figure:{"> div":{backgroundColor:"$primaryAlt","&::before":{position:"absolute",zIndex:"1",color:"$secondaryMuted",content:"Active Item",textTransform:"uppercase",fontWeight:"700",fontSize:"0.6111rem",letterSpacing:"0.03rem",display:"flex",width:"100%",height:"100%",flexDirection:"column",justifyContent:"center",textAlign:"center",textShadow:"5px 5px 5px #0003"},img:{opacity:"0.3",transform:"scale3d(1.1, 1.1, 1.1)",filter:"blur(2px)"},[`& ${Ce}`]:{[`& ${He.Tag}`]:{backgroundColor:"$accent"}}}},figcaption:{fontWeight:"700",color:"$primary"}}});var Ot=require("@samvera/nectar-iiif");var hr=({type:e})=>{switch(e){case"Sound":return k.default.createElement(U.Icon.Audio,null);case"Image":return k.default.createElement(U.Icon.Image,null);case"Video":return k.default.createElement(U.Icon.Video,null);default:return k.default.createElement(U.Icon.Image,null)}},br=({canvas:e,canvasIndex:t,isActive:o,thumbnail:r,type:n,handleChange:l})=>k.default.createElement(Ht,{"aria-checked":o,"data-testid":"media-thumbnail","data-canvas":t,onClick:()=>l(e.id),value:e.id},k.default.createElement("figure",null,k.default.createElement("div",null,(r==null?void 0:r.id)&&k.default.createElement("img",{src:r.id,alt:e!=null&&e.label?H(e.label):""}),k.default.createElement(Ce,null,k.default.createElement(U.Tag,{isIcon:!0,"data-testid":"thumbnail-tag"},k.default.createElement(Bt,null),k.default.createElement(U.Icon,{"aria-label":n},k.default.createElement(hr,{type:n})),["Video","Sound"].includes(n)&&k.default.createElement(Dt,null,ye(e.duration))))),(e==null?void 0:e.label)&&k.default.createElement("figcaption",{"data-testid":"fig-caption"},k.default.createElement(Ot.Label,{label:e.label})))),Gt=br;var Ut=e=>e.body?e.body.type:"Image";var g=m(require("react"));var Oe=a("div",{position:"absolute",right:"1rem",top:"1rem",display:"flex",justifyContent:"flex-end",zIndex:"1"}),Rt=a("input",{flexGrow:"1",border:"none",backgroundColor:"$secondaryMuted",color:"$primary",marginRight:"1rem",height:"2rem",padding:"0 1rem",borderRadius:"2rem",fontFamily:"$sans",fontSize:"1rem",lineHeight:"1rem",boxShadow:"inset 1px 1px 2px #0003","&::placeholder":{color:"$primaryMuted"}}),ve=a("button",{display:"flex",background:"none",border:"none",width:"2rem !important",height:"2rem !important",padding:"0",margin:"0",fontWeight:"700",borderRadius:"2rem",backgroundColor:"$accent",color:"$secondary",cursor:"pointer",boxSizing:"content-box !important",transition:"$all",svg:{height:"60%",width:"60%",padding:"20%",fill:"$secondary",stroke:"$secondary",opacity:"1",filter:"drop-shadow(5px 5px 5px #000D)",boxSizing:"inherit",transition:"$all"},"&:disabled":{backgroundColor:"transparent",boxShadow:"none",svg:{opacity:"0.25"}}}),jt=a("div",{display:"flex",marginRight:"0.618rem",backgroundColor:"$accentAlt",borderRadius:"2rem",boxShadow:"5px 5px 5px #0003",color:"$secondary",alignItems:"center","> span":{display:"flex",margin:"0 0.5rem",fontSize:"0.7222rem"}}),qt=a("div",{display:"flex",position:"relative",zIndex:"1",width:"100%",padding:"0",transition:"$all",variants:{isToggle:{true:{paddingTop:"2.618rem",[`& ${Oe}`]:{width:"calc(100% - 2rem)","@sm":{width:"calc(100% - 2rem)"}}}}}});var Zt=require("react"),xr=(e,t)=>{(0,Zt.useEffect)(()=>{function o(r){r.key===e&&t()}return window.addEventListener("keyup",o),()=>window.removeEventListener("keyup",o)},[])},_t=xr;var yr=()=>g.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},g.default.createElement("title",null,"Arrow Back"),g.default.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"10",strokeWidth:"45",d:"M244 400L100 256l144-144M120 256h292"})),Cr=()=>g.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},g.default.createElement("title",null,"Arrow Forward"),g.default.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"10",strokeWidth:"45",d:"M268 112l144 144-144 144M392 256H100"})),vr=()=>g.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},g.default.createElement("title",null,"Close"),g.default.createElement("path",{d:"M289.94 256l95-95A24 24 0 00351 127l-95 95-95-95a24 24 0 00-34 34l95 95-95 95a24 24 0 1034 34l95-95 95 95a24 24 0 0034-34z"})),Ir=()=>g.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},g.default.createElement("title",null,"Search"),g.default.createElement("path",{d:"M456.69 421.39L362.6 327.3a173.81 173.81 0 0034.84-104.58C397.44 126.38 319.06 48 222.72 48S48 126.38 48 222.72s78.38 174.72 174.72 174.72A173.81 173.81 0 00327.3 362.6l94.09 94.09a25 25 0 0035.3-35.3zM97.92 222.72a124.8 124.8 0 11124.8 124.8 124.95 124.95 0 01-124.8-124.8z"})),wr=({handleCanvasToggle:e,handleFilter:t,activeIndex:o,canvasLength:r})=>{let[n,l]=(0,g.useState)(!1),[s,d]=(0,g.useState)(!1),[i,f]=(0,g.useState)(!1);(0,g.useEffect)(()=>{f(o===0),o===r-1?d(!0):d(!1)},[o]),_t("Escape",()=>{l(!1),t("")});let h=()=>{l(b=>!b),t("")};return g.default.createElement(qt,{isToggle:n},g.default.createElement(Oe,null,n&&g.default.createElement(Rt,{autoFocus:!0,onChange:b=>t(b.target.value),placeholder:"Search"}),!n&&g.default.createElement(jt,null,g.default.createElement(ve,{onClick:()=>e(-1),disabled:i,type:"button"},g.default.createElement(yr,null)),g.default.createElement("span",null,o+1," of ",r),g.default.createElement(ve,{onClick:()=>e(1),disabled:s,type:"button"},g.default.createElement(Cr,null))),g.default.createElement(ve,{onClick:h,type:"button"},n?g.default.createElement(vr,null):g.default.createElement(Ir,null))))},Kt=wr;var Sr=({items:e})=>{let t=O(),o=w(),{activeCanvas:r,vault:n}=o,[l,s]=(0,E.useState)(""),[d,i]=(0,E.useState)([]),[f,h]=(0,E.useState)(0),p=E.default.useRef(null),b="painting",x=["Image","Sound","Video"],c=u=>{r!==u&&t({type:"updateActiveCanvas",canvasId:u})};return(0,E.useEffect)(()=>{if(!d.length){let u=e.map(v=>j(n,v,b,x)).filter(v=>v.annotations.length>0);i(u)}},[]),(0,E.useEffect)(()=>{d.forEach((u,v)=>{u!=null&&u.canvas&&u.canvas.id===r&&h(v)})},[r]),(0,E.useEffect)(()=>{let u=document.querySelector(`[data-canvas="${f}"]`);if(u instanceof HTMLElement&&p.current){let v=u.offsetLeft-p.current.offsetWidth/2+u.offsetWidth/2;p.current.scrollTo({left:v,behavior:"smooth"})}},[f]),E.default.createElement(E.default.Fragment,null,E.default.createElement(Kt,{handleFilter:u=>s(u),handleCanvasToggle:u=>{let v=d[f+u];v!=null&&v.canvas&&c(v.canvas.id)},activeIndex:f,canvasLength:d.length}),E.default.createElement(zt,{"aria-label":"select item","data-testid":"media",ref:p},d.filter(u=>{var v;if((v=u.canvas)!=null&&v.label){let B=H(u.canvas.label);if(Array.isArray(B))return B[0].toLowerCase().includes(l.toLowerCase())}}).map((u,v)=>{var B,Q;return E.default.createElement(Gt,{canvas:u.canvas,canvasIndex:v,handleChange:c,isActive:r===((B=u==null?void 0:u.canvas)==null?void 0:B.id),key:(Q=u==null?void 0:u.canvas)==null?void 0:Q.id,thumbnail:Me(n,u,200,200),type:Ut(u.annotations[0])})})))},Xt=Sr;var F=m(require("react"));var R=m(require("@radix-ui/react-tabs"));var Qt=a(R.Root,{display:"flex",flexDirection:"column",width:"100%",height:"100%",flexGrow:"1",flexShrink:"0",position:"relative",zIndex:"1",boxShadow:"-5px -5px 5px #00000011","@sm":{marginTop:"0.5rem",boxShadow:"none"},"&:after":{position:"absolute",bottom:0,content:"",width:"100%",height:"1rem",backgroundImage:"linear-gradient(0deg, #FFFFFF 0%, #FFFFFF00 100%)",zIndex:1,"@sm":{backgroundImage:"none"}}}),Yt=a(R.List,{display:"flex",flexGrow:"0",margin:"0 1.618rem",borderBottom:"4px solid $secondaryAlt",backgroundColor:"$secondary","@sm":{margin:"0 1rem"}}),Ge=a(R.Trigger,{display:"flex",position:"relative",padding:"0.5rem 1rem",background:"none",backgroundColor:"transparent",color:"$primaryMuted",border:"none",fontFamily:"inherit",fontSize:"1rem",marginRight:"1rem",lineHeight:"1rem",whiteSpace:"nowrap",cursor:"pointer",fontWeight:700,transition:"$all","&::after":{width:"0",height:"4px",content:"",backgroundColor:"$primaryMuted",position:"absolute",bottom:"-4px",left:"0",transition:"$all"},"&:hover":{color:"$primary"},"&[data-state='active']":{color:"$accent","&::after":{width:"100%",backgroundColor:"$accent"}}}),Ue=a(R.Content,{display:"flex",flexGrow:"1",flexShrink:"0",position:"absolute",top:"0",left:"0","&[data-state='active']":{width:"100%",height:"calc(100% - 2rem)",padding:"1rem 0"}}),Jt=a("div",{position:"relative",height:"100%",width:"100%",overflowY:"scroll"});var ee=m(require("react"));var Ie=m(require("@radix-ui/react-radio-group"));var eo=lt({from:{transform:"rotate(360deg)"},to:{transform:"rotate(0deg)"}}),to=a(Ie.Root,{display:"flex",flexDirection:"column",width:"100%"}),we=a(Ie.Item,{position:"relative",cursor:"pointer",display:"flex",width:"100%",justifyContent:"space-between",textAlign:"left",margin:"0",padding:"0.5rem 1.618rem",fontFamily:"inherit",lineHeight:"1.25em",fontSize:"1rem",color:"$primaryMuted",border:"none",background:"none","@sm":{padding:"0.5rem 1rem",fontSize:"0.8333rem"},"&::before":{content:"",width:"12px",height:"12px",borderRadius:"12px",position:"absolute",backgroundColor:"$primaryMuted",opacity:"0",left:"8px",marginTop:"3px",boxSizing:"content-box","@sm":{content:"unset"}},"&::after":{content:"",width:"4px",height:"6px",position:"absolute",backgroundColor:"$secondary",opacity:"0",clipPath:"polygon(100% 50%, 0 100%, 0 0)",left:"13px",marginTop:"6px",boxSizing:"content-box","@sm":{content:"unset"}},strong:{marginLeft:"1rem"},"&:hover":{color:"$accent","&::before":{backgroundColor:"$accent",opacity:"1"},"&::after":{content:"",width:"4px",height:"6px",position:"absolute",backgroundColor:"$secondary",clipPath:"polygon(100% 50%, 0 100%, 0 0)",opacity:"1"}},"&[aria-checked='true']":{color:"$primary",backgroundColor:"$secondaryMuted",fontFamily:"$sansBold","&::before":{content:"",width:"6px",height:"6px",position:"absolute",backgroundColor:"transparent",border:"3px solid $accentMuted",borderRadius:"12px",left:"8px",marginTop:"4px",opacity:"1",animation:"1s linear infinite",animationName:eo,boxSizing:"content-box","@sm":{content:"unset"}},"&::after":{content:"",width:"6px",height:"6px",position:"absolute",backgroundColor:"transparent",border:"3px solid $accent",clipPath:"polygon(100% 0, 100% 100%, 0 0)",borderRadius:"12px",left:"8px",marginTop:"4px",opacity:"1",animation:"1.5s linear infinite",animationName:eo,boxSizing:"content-box","@sm":{content:"unset"}}}});var oo=require("uuid"),Tr=()=>{function e(n){return n.map(s=>{let d=s.identifier||(0,oo.v4)();return{...s,identifier:d}})}function t(n){let l=e(n);function s(i,f){let h=[];return i.forEach(p=>{let x=i.filter(c=>p.start>=c.start&&p.end<=c.end&&p.identifier!==c.identifier).sort((c,M)=>{let y=c.end-c.start,u=M.end-M.start;return y===u?0:y<u?-1:1})[0];if(!x&&!f||(x==null?void 0:x.identifier)===f){let c=s(i,p.identifier);c.length&&(p.children=c),h.push(p)}}),h}return s(l,null)}function o(n,l=[]){return l.some(s=>n.start>=s.start&&n.end<=s.end)}function r(n=[]){return n.sort((l,s)=>l.start-s.start)}return{addIdentifiersToParsedCues:e,createNestedCues:t,isChild:o,orderCuesByTime:r}},ro=Tr;var de=m(require("react"));var Se=m(require("react"));var se=m(require("react")),no={currentTime:0,startTime:0,updateStartTime:()=>{},updateCurrentTime:()=>{}},le=se.default.createContext(no),io=({children:e})=>{let[t,o]=se.default.useState(no.currentTime),[r,n]=se.default.useState(0),l=d=>n(d),s=d=>o(d);return se.default.createElement(le.Provider,{value:{currentTime:t,startTime:r,updateStartTime:l,updateCurrentTime:s}},e)};var kr=({label:e,start:t,end:o})=>{let{currentTime:r,updateStartTime:n}=Se.default.useContext(le),l=t<=r&&r<o;return Se.default.createElement(we,{"aria-checked":l,"data-testid":"navigator-cue",onClick:()=>{n(t)},value:e},e,Se.default.createElement("strong",null,ye(t)))},ao=kr;var so=a("ul",{listStyle:"none",paddingLeft:"1rem",position:"relative","&&:first-child":{paddingLeft:"0"},"& li ul":{[`& ${we}`]:{backgroundColor:"unset","&::before":{content:"none"},"&::after":{content:"none"}}},"&:first-child":{margin:"0 0 1.618rem"}});var lo=({items:e})=>de.default.createElement(so,null,e.map(({text:t,start:o,end:r,children:n,identifier:l})=>de.default.createElement("li",{key:l},de.default.createElement(ao,{label:t,start:o,end:r}),n&&de.default.createElement(lo,{items:n})))),mo=lo;var po=require("node-webvtt"),Fr=({resource:e})=>{let[t,o]=ee.default.useState([]),{id:r,label:n}=e,{createNestedCues:l,orderCuesByTime:s}=ro();return(0,ee.useEffect)(()=>{fetch(r,{headers:{"Content-Type":"text/plain",Accept:"application/json"}}).then(d=>d.text()).then(d=>{let i=(0,po.parse)(d).cues,f=s(i),h=l(f);o(h)}).catch(d=>console.error(r,d.toString()))},[r]),ee.default.createElement(to,{"aria-label":`navigate ${H(n,"en")}`},ee.default.createElement(mo,{items:t}))},co=Fr;var Io=require("@samvera/nectar-iiif");var uo=a("div",{padding:" 0 1.618rem 2rem",display:"flex",flexDirection:"column",overflow:"scroll",position:"absolute",color:"$primary",fontFamily:"$sans",fontWeight:"400",fontSize:"1rem",zIndex:"0",img:{maxWidth:"100px",maxHeight:"100px",objectFit:"contain",color:"transparent",margin:"0 0 1rem",borderRadius:"3px",backgroundColor:"$secondaryMuted"},video:{display:"none"},"a, a:visited":{color:"$accent"},p:{fontSize:"1rem",lineHeight:"1.45em",margin:"0"},dl:{margin:"0",dt:{fontWeight:"700",margin:"1rem 0 0.25rem"},dd:{margin:"0"}},".manifest-property-title":{fontWeight:"700",margin:"1rem 0 0.25rem"},"ul, ol":{padding:"0",margin:"0",li:{fontSize:"1rem",lineHeight:"1.45em",listStyle:"none",margin:"0.25rem 0 0.25rem"}}}),fo=a("div",{position:"relative",width:"100%",height:"100%",zIndex:"0"});var go=require("@samvera/nectar-iiif"),Z=m(require("react")),Pr=({homepage:e})=>(e==null?void 0:e.length)===0?Z.default.createElement(Z.default.Fragment,null):Z.default.createElement(Z.default.Fragment,null,Z.default.createElement("span",{className:"manifest-property-title"},"Homepage"),Z.default.createElement(go.Homepage,{homepage:e})),Re=Pr;var me=m(require("react")),$r=({id:e,htmlLabel:t,parent:o="manifest"})=>me.default.createElement(me.default.Fragment,null,me.default.createElement("span",{className:"manifest-property-title"},t),me.default.createElement("a",{href:e,target:"_blank",id:`iiif-${o}-id`},e)),je=$r;var te=m(require("react")),ho=require("@samvera/nectar-iiif"),Er=({metadata:e,parent:t="manifest"})=>e?te.default.createElement(te.default.Fragment,null,te.default.createElement(ho.Metadata,{metadata:e,id:`iiif-${t}-metadata`})):te.default.createElement(te.default.Fragment,null),qe=Er;var oe=m(require("react")),bo=require("@samvera/nectar-iiif"),Ar=({requiredStatement:e,parent:t="manifest"})=>e?oe.default.createElement(oe.default.Fragment,null,oe.default.createElement(bo.RequiredStatement,{requiredStatement:e,id:`iiif-${t}-required-statement`})):oe.default.createElement(oe.default.Fragment,null),Ze=Ar;var _=m(require("react")),Mr=({rights:e})=>e?_.default.createElement(_.default.Fragment,null,_.default.createElement("span",{className:"manifest-property-title"},"Rights"),_.default.createElement("a",{href:e,target:"_blank"},e)):_.default.createElement(_.default.Fragment,null),_e=Mr;var xo=require("@samvera/nectar-iiif"),K=m(require("react")),Wr=({seeAlso:e})=>(e==null?void 0:e.length)===0?K.default.createElement(K.default.Fragment,null):K.default.createElement(K.default.Fragment,null,K.default.createElement("span",{className:"manifest-property-title"},"See Also"),K.default.createElement(xo.SeeAlso,{seeAlso:e})),Ke=Wr;var re=m(require("react")),yo=require("@samvera/nectar-iiif"),Lr=({summary:e,parent:t="manifest"})=>e?re.default.createElement(re.default.Fragment,null,re.default.createElement(yo.Summary,{summary:e,as:"p",id:`iiif-${t}-summary`})):re.default.createElement(re.default.Fragment,null),Xe=Lr;var ne=m(require("react")),Co=require("@samvera/nectar-iiif"),Vr=({label:e,thumbnail:t})=>(t==null?void 0:t.length)===0?ne.default.createElement(ne.default.Fragment,null):ne.default.createElement(ne.default.Fragment,null,ne.default.createElement(Co.Thumbnail,{altAsLabel:e||{none:["resource"]},thumbnail:t})),Qe=Vr;var I=m(require("react"));var zr=()=>{let e=w(),{activeManifest:t,vault:o}=e,[r,n]=(0,I.useState)(),[l,s]=(0,I.useState)([]),[d,i]=(0,I.useState)([]),[f,h]=(0,I.useState)([]);return(0,I.useEffect)(()=>{var b,x,c;let p=o.get(t);n(p),((b=p.homepage)==null?void 0:b.length)>0&&s(o.get(p.homepage)),((x=p.seeAlso)==null?void 0:x.length)>0&&i(o.get(p.seeAlso)),((c=p.thumbnail)==null?void 0:c.length)>0&&h(o.get(p.thumbnail))},[t,o]),r?I.default.createElement(fo,null,I.default.createElement(uo,null,I.default.createElement(Qe,{thumbnail:f,label:r.label}),I.default.createElement(Xe,{summary:r.summary}),I.default.createElement(qe,{metadata:r.metadata}),I.default.createElement(Ze,{requiredStatement:r.requiredStatement}),I.default.createElement(_e,{rights:r.rights}),I.default.createElement(Re,{homepage:l}),I.default.createElement(Ke,{seeAlso:d}),I.default.createElement(je,{id:r.id,htmlLabel:"IIIF Manifest"}))):I.default.createElement(I.default.Fragment,null)},vo=zr;var Nr=({activeCanvas:e,resources:t})=>{let o=w(),{configOptions:r}=o,{renderAbout:n}=r,[l,s]=(0,F.useState)();(0,F.useEffect)(()=>{n?s("manifest-about"):t&&(t==null?void 0:t.length)>0&&!n&&s(t[0].id)},[e,t]);let d=i=>{s(i)};return t?F.default.createElement(Qt,{"data-testid":"navigator",defaultValue:l,onValueChange:d,orientation:"horizontal",value:l},F.default.createElement(Yt,{"aria-label":"select chapter","data-testid":"navigator-list"},n&&F.default.createElement(Ge,{value:"manifest-about"},"About"),t&&t.map(({id:i,label:f})=>F.default.createElement(Ge,{key:i,value:i},F.default.createElement(Io.Label,{label:f})))),F.default.createElement(Jt,null,n&&F.default.createElement(Ue,{value:"manifest-about"},F.default.createElement(vo,null)),t&&t.map(i=>F.default.createElement(Ue,{key:i.id,value:i.id},F.default.createElement(co,{resource:i}))))):F.default.createElement(F.default.Fragment,null)},wo=Nr;var z=m(require("react")),ie=m(require("hls.js"));var So=a("div",{position:"relative",backgroundColor:"$primaryAlt",display:"flex",flexGrow:"0",flexShrink:"1",maxHeight:"500px",zIndex:"1",video:{backgroundColor:"transparent",display:"flex",position:"relative",objectFit:"contain",width:"100%",height:"100%",zIndex:"1"}});var pe=m(require("react"));var To=a("canvas",{position:"absolute",width:"100%",height:"100%"});var Br=pe.default.forwardRef((e,t)=>{let o=pe.default.useRef(null);pe.default.useEffect(()=>{!t||(t.current.onplay=r)},[t]);function r(){let l=t.current,s=new AudioContext,d=s.createMediaElementSource(l),i=s.createAnalyser(),f=o.current;if(!f)return;f.width=l.offsetWidth,f.height=l.offsetHeight;let h=f.getContext("2d");d.connect(i),i.connect(s.destination),i.fftSize=256;let p=i.frequencyBinCount,b=new Uint8Array(p);setInterval(function(){n(i,h,p,b,f.width,f.height)},20)}function n(l,s,d,i,f,h){let p=f/d*2.6,b,x=0;l.getByteFrequencyData(i),s.fillStyle="#000000",s.fillRect(0,0,f,h);for(let c=0;c<d;c++)b=i[c]*2,s.fillStyle=`rgba(${78}, 42, 132, 1)`,s.fillRect(x,h-b,p,b),x+=p+6}return pe.default.createElement(To,{ref:o})}),ko=Br;var Fo=m(require("react"));var Dr=({resource:e,ignoreCaptionLabels:t})=>{let o=H(e.label,"en");return o.some(n=>t.includes(n))?null:Fo.default.createElement("track",{key:e.id,src:e.id,label:o,srcLang:"en","data-testid":"player-track"})},Po=Dr;var Hr=({painting:e,resources:t})=>{var x;let o=z.default.useRef(null),r=(x=e==null?void 0:e.format)==null?void 0:x.includes("audio/"),{startTime:n,updateCurrentTime:l}=z.default.useContext(le),s=w(),{activeCanvas:d,configOptions:i,vault:f}=s,h=j(f,{id:d,type:"Canvas"},"painting",["Image"]),p=$e(h.accompanyingCanvas);z.default.useEffect(()=>{if(!e.id||!o.current||e.id.split(".").pop()!=="m3u8")return;let c=new ie.default;return c.attachMedia(o.current),c.on(ie.default.Events.MEDIA_ATTACHED,function(){c.loadSource(e.id)}),c.on(ie.default.Events.ERROR,function(M,y){if(y.fatal)switch(y.type){case ie.default.ErrorTypes.NETWORK_ERROR:console.error(`fatal ${M} network error encountered, try to recover`),c.startLoad();break;case ie.default.ErrorTypes.MEDIA_ERROR:console.error(`fatal ${M} media error encountered, try to recover`),c.recoverMediaError();break;default:c.destroy();break}}),()=>{c&&(c.detachMedia(),c.destroy(),l(0))}},[e.id]),z.default.useEffect(()=>{let c=o.current;c&&(c.currentTime=n),n!==0&&c.play()},[n]);let b=()=>{let c=o.current;c&&(c.ontimeupdate=M=>{l(M.target.currentTime)})};return z.default.createElement(So,{css:{backgroundColor:i.canvasBackgroundColor,maxHeight:i.canvasHeight}},z.default.createElement("video",{id:"clover-iiif-video",key:e.id,ref:o,controls:!0,height:e.height,width:e.width,onPlay:b,crossOrigin:"anonymous",poster:p},z.default.createElement("source",{src:e.id,type:e.format}),t.length>0&&t.map(c=>z.default.createElement(Po,{resource:c,ignoreCaptionLabels:i.ignoreCaptionLabels,key:c.id})),"Sorry, your browser doesn't support embedded videos."),r&&z.default.createElement(ko,{ref:o}))},$o=Hr;var X=m(require("react"));var N=m(require("react")),Ye=m(require("openseadragon"));var Eo=a("div",{position:"absolute !important",zIndex:"1",top:"1rem",left:"1rem",width:"161.8px",height:"100px",backgroundColor:"#000D",boxShadow:"5px 5px 5px #0002",borderRadius:"3px",".displayregion":{border:" 3px solid $accent !important",boxShadow:"0 0 3px #0006"},"@sm":{width:"123px",height:"76px"}}),Ao=a("div",{position:"relative",width:"100%",height:"100%",zIndex:"0"}),Mo=a("div",{width:"100%",height:"61.8vh",maxHeight:"100vh",background:"black",backgroundSize:"contain",color:"white",position:"relative",zIndex:"1",overflow:"hidden"});var A=m(require("react"));var Te=m(require("react"));var Wo=a("button",{display:"flex",height:"2rem",width:"2rem",borderRadius:"2rem",padding:"0",margin:"0",fontFamily:"inherit",background:"none",border:"none",color:"white",cursor:"pointer",marginLeft:"0.618rem",backgroundColor:"#000D",filter:"drop-shadow(5px 5px 5px #0006)",transition:"$all",boxSizing:"content-box !important",svg:{height:"60%",width:"60%",padding:"20%",fill:"$secondary",stroke:"$secondary",filter:"drop-shadow(5px 5px 5px #000D)",transition:"$all",boxSizing:"inherit"},"&:hover, &:focus":{backgroundColor:"$accent"},"&#zoomReset":{"&:hover, &:focus":{svg:{rotate:"45deg"}}}});var Or=({id:e,label:t,children:o})=>Te.default.createElement(Wo,{id:e,"data-testid":"openseadragon-button"},Te.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg","aria-labelledby":`${e}-svg-title`,"data-testid":"openseadragon-button-svg",focusable:"false",viewBox:"0 0 512 512",role:"img"},Te.default.createElement("title",{id:`${e}-svg-title`},t),o)),ke=Or;var Lo=a("div",{position:"absolute",zIndex:"1",top:"1rem",right:"1rem"});var Gr=()=>A.default.createElement(Lo,{"data-testid":"openseadragon-controls",id:"openseadragon-controls"},A.default.createElement(ke,{id:"zoomIn",label:"zoom in"},A.default.createElement(()=>A.default.createElement("path",{strokeLinecap:"round",strokeMiterlimit:"10",strokeWidth:"45",d:"M256 112v288M400 256H112"}),null)),A.default.createElement(ke,{id:"zoomOut",label:"zoom in"},A.default.createElement(()=>A.default.createElement("path",{strokeLinecap:"round",strokeMiterlimit:"10",strokeWidth:"45",d:"M400 256H112"}),null)),A.default.createElement(ke,{id:"zoomReset",label:"reset zoom"},A.default.createElement(()=>A.default.createElement(A.default.Fragment,null,A.default.createElement("path",{fill:"none",strokeLinecap:"round",strokeMiterlimit:"10",strokeWidth:"45",d:"M400 148l-21.12-24.57A191.43 191.43 0 00240 64C134 64 48 150 48 256s86 192 192 192a192.09 192.09 0 00181.07-128"}),A.default.createElement("path",{d:"M464 97.42V208a16 16 0 01-16 16H337.42c-14.26 0-21.4-17.23-11.32-27.31L436.69 86.1C446.77 76 464 83.16 464 97.42z"})),null))),Vo=Gr;var zo=e=>fetch(`${e.replace(/\/$/,"")}/info.json`).then(t=>t.json()).then(t=>t).catch(t=>{console.error(`The IIIF tilesource ${e.replace(/\/$/,"")}/info.json failed to load: ${t}`)}),No=e=>{let t,o;if(Array.isArray(e)&&(t=e[0],t)){let r;"@id"in t?r=t["@id"]:r=t.id,o=r}return o};var Bo=require("uuid");var Ur=({uri:e,imageType:t})=>{let[o,r]=(0,N.useState)(),n=w(),{configOptions:l}=n,s=(0,Bo.v4)(),d={id:`openseadragon-viewport-${s}`,loadTilesWithAjax:!0,homeButton:"zoomReset",showFullPageControl:!1,zoomInButton:"zoomIn",zoomOutButton:"zoomOut",showNavigator:!0,navigatorBorderColor:"transparent",navigatorId:`openseadragon-navigator-${s}`,gestureSettingsMouse:{clickToZoom:!0,dblClickToZoom:!0,pinchToZoom:!0,scrollToZoom:!1}};return(0,N.useEffect)(()=>{e!==o&&r(e)},[]),(0,N.useEffect)(()=>{if(o)switch(t){case"simpleImage":(0,Ye.default)(d).addSimpleImage({url:o});break;case"tiledImage":zo(o).then(i=>(0,Ye.default)(d).addTiledImage({tileSource:i}));break;default:console.warn(`Unable to render ${o} in OpenSeadragon as type: "${t}"`);break}},[o]),N.default.createElement(Mo,{css:{backgroundColor:l.canvasBackgroundColor,height:l.canvasHeight}},N.default.createElement(Vo,null),N.default.createElement(Eo,{id:`openseadragon-navigator-${s}`}),N.default.createElement(Ao,{id:`openseadragon-viewport-${s}`}))},Do=Ur;var Rr=({body:e})=>{let[t,o]=(0,X.useState)(),[r,n]=(0,X.useState)();return(0,X.useEffect)(()=>{Array.isArray(e.service)&&e.service.length>0?(o("tiledImage"),n(No(e.service))):(o("simpleImage"),n(e.id))},[e]),X.default.createElement(Do,{uri:r,key:r,imageType:t})},Ho=Rr;var Oo=require("@nulib/design-system");var jr=({activeCanvas:e,painting:t,resources:o,items:r,isAbout:n,isInformation:l,isNavigator:s,isNavigatorOpen:d,isMedia:i})=>W.default.createElement(Ve,{className:"clover-content"},W.default.createElement(io,null,W.default.createElement(ze,null,i?W.default.createElement($o,{painting:t,resources:o}):t&&W.default.createElement(Ho,{body:t,key:e}),W.default.createElement(dt,null,W.default.createElement(Oo.Button,{as:"span"},d?"View Items":"More Information")),r.length>1&&W.default.createElement(Le,{className:"clover-canvases"},W.default.createElement(Xt,{items:r,activeItem:0}))),l&&(n||s)&&W.default.createElement(mt,null,W.default.createElement(Ne,null,W.default.createElement(wo,{activeCanvas:e,resources:o}))))),Go=jr;var Fe=m(require("react"));var Uo=a("div",{display:"flex",flexDirection:"column",alignItems:"center"}),Ro=a("p",{fontFamily:"$display",fontWeight:"bold",fontSize:"x-large"}),jo=a("span",{fontSize:"medium"});var qr=({error:e})=>{let{message:t}=e;return Fe.default.createElement(Uo,{role:"alert"},Fe.default.createElement(Ro,{"data-testid":"headline"},"Something went wrong"),t&&Fe.default.createElement(jo,null,`Error message: ${t}`," "))},qo=qr;var _o=require("react-error-boundary"),Zr=({manifest:e,theme:t})=>{let o=w(),{activeCanvas:r,informationExpanded:n,vault:l,configOptions:s}=o,[d,i]=(0,$.useState)(!1),[f,h]=(0,$.useState)(!1),[p,b]=(0,$.useState)(!0),[x,c]=(0,$.useState)(void 0),[M,y]=(0,$.useState)([]),[u,v]=ut(!1),B=ct(We.sm);return(0,$.useEffect)(()=>{if(!B){b(!0);return}b(!1)},[B]),(0,$.useEffect)(()=>{if(!B){v(!1);return}v(p)},[p]),(0,$.useEffect)(()=>{let Q=Ee(l,r),Je=Ae(l,r,"text/vtt");Q&&(i(["Sound","Video"].indexOf(Q.type)>-1),c({...Q})),y(Je),h(Je.length!==0)},[r]),$.default.createElement(_o.ErrorBoundary,{FallbackComponent:qo},$.default.createElement(pt,{className:`${t} clover-iiif`,"data-body-locked":u,"data-navigator":f,"data-navigator-open":p},$.default.createElement(Zo.Root,{open:p,onOpenChange:b},$.default.createElement(Lt,{manifestLabel:e.label,manifestId:e.id}),$.default.createElement(Go,{activeCanvas:r,painting:x,resources:M,items:e.items,isAbout:s.renderAbout,isMedia:d,isInformation:n,isNavigator:f,isNavigatorOpen:p}))))},Ko=Zr;var Xo=require("@stitches/react"),_r=({canvasIdCallback:e=()=>{},customTheme:t,id:o,manifestId:r,options:n})=>T.default.createElement(it,null,T.default.createElement(Kr,{id:o,manifestId:r,canvasIdCallback:e,customTheme:t,options:n})),Kr=({canvasIdCallback:e,customTheme:t,id:o,manifestId:r,options:n})=>{let l=O(),s=w(),{activeCanvas:d,activeManifest:i,isLoaded:f,vault:h}=s,[p,b]=(0,T.useState)(),[x,c]=(0,T.useState)(),M={};return t&&(M=(0,Xo.createTheme)("custom",t)),(0,T.useEffect)(()=>{e&&e(d)},[d]),(0,T.useEffect)(()=>{i&&h.loadManifest(i).then(y=>{c(y),l({type:"updateActiveCanvas",canvasId:y.items[0]&&y.items[0].id})}).catch(y=>{console.error(`Manifest failed to load: ${y}`)}).finally(()=>{l({type:"updateIsLoaded",isLoaded:!0})})},[i]),(0,T.useEffect)(()=>{let y=o;r&&(y=r),l({type:"updateConfigOptions",configOptions:n}),h.load(y).then(u=>{b(u)}).catch(u=>{console.error(`The IIIF resource ${y} failed to load: ${u}`)})},[o,n]),(0,T.useEffect)(()=>{let y=[];(p==null?void 0:p.type)==="Collection"?(l({type:"updateCollection",collection:p}),y=p.items.filter(u=>u.type==="Manifest").map(u=>u.id),y.length>0&&l({type:"updateActiveManifest",manifestId:y[0]})):(p==null?void 0:p.type)==="Manifest"&&l({type:"updateActiveManifest",manifestId:p.id})},[p]),f?!x||!x.items?(console.log(`The IIIF manifest ${r} failed to load.`),T.default.createElement(T.default.Fragment,null)):x.items.length===0?(console.log(`The IIIF manifest ${r} does not contain canvases.`),T.default.createElement(T.default.Fragment,null)):T.default.createElement(Ko,{manifest:x,theme:M,key:x.id}):T.default.createElement(T.default.Fragment,null,"Loading")},Xr=_r;
//# sourceMappingURL=index.cjs.js.map
