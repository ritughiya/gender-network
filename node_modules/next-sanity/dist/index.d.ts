import {ClientConfig} from '@sanity/client'
import type {Config} from '@sanity/groq-store/dist/typings/types'
import {default as groq} from 'groq'
import {SanityClient} from '@sanity/client'

/** @public */
export declare interface Aborter {
  abort(): void
  signal: AbortSignal
}

export {ClientConfig}

/** @public */
export declare function createClient(config: ClientConfig): SanityClient

/** @public */
export declare function createCurrentUserHook({
  projectId,
}: {
  projectId: string
  dataset?: string
}): () => {
  data: CurrentUser | null | undefined
  error: Error | undefined
  loading: boolean
}

/** @public */
export declare function createPreviewSubscriptionHook({
  projectId,
  dataset,
  token,
  EventSource,
  documentLimit,
  includeTypes,
}: ProjectConfig & {
  documentLimit?: number
  includeTypes?: string[]
}): <R = any>(
  query: string,
  options?: SubscriptionOptions<R>
) => {
  data: R
  loading: boolean
  error: Error | undefined
}

/** @public */
export declare interface CurrentUser {
  id: string
  name: string
  profileImage?: string
}

export {groq}

/** @public */
export declare type GroqStoreEventSource = Config['EventSource']

/** @public */
export declare type Params = Record<string, unknown>

/** @public */
export declare interface ProjectConfig {
  projectId: string
  dataset: string
  token?: string
  /** Must be provided when token is used in browser, as native EventSource does not support auth-headers. */
  EventSource?: GroqStoreEventSource
}

export {SanityClient}

/** @public */
export declare interface SubscriptionOptions<R = any> {
  enabled?: boolean
  params?: Params
  initialData?: R
}

export {}
